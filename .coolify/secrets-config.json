{
    "secrets_management": {
        "description": "Comprehensive secrets configuration for Coolify deployment",
        "version": "1.0.0",
        "security_level": "production",
        "secrets": {
            "authentication": {
                "JWT_SECRET": {
                    "description": "Primary JWT signing secret for access tokens",
                    "type": "random_string",
                    "length": 64,
                    "charset": "alphanumeric_special",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 90,
                        "grace_period_days": 7
                    },
                    "validation": {
                        "min_length": 32,
                        "entropy_bits": 256,
                        "pattern": "^[A-Za-z0-9!@#$%^&*()_+=-]{32,}$"
                    },
                    "usage": [
                        "Access token signing",
                        "Refresh token signing",
                        "API authentication"
                    ]
                },
                "SESSION_SECRET": {
                    "description": "Session encryption and signing secret",
                    "type": "random_string",
                    "length": 32,
                    "charset": "alphanumeric_special",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 60,
                        "grace_period_days": 5
                    },
                    "validation": {
                        "min_length": 16,
                        "entropy_bits": 128,
                        "pattern": "^[A-Za-z0-9!@#$%^&*()_+=-]{16,}$"
                    },
                    "usage": [
                        "Session cookie signing",
                        "Session data encryption",
                        "CSRF token generation"
                    ]
                },
                "REFRESH_TOKEN_SECRET": {
                    "description": "Separate secret for refresh token signing",
                    "type": "random_string",
                    "length": 64,
                    "charset": "alphanumeric_special",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 180,
                        "grace_period_days": 14
                    },
                    "validation": {
                        "min_length": 32,
                        "entropy_bits": 256
                    },
                    "usage": [
                        "Refresh token signing",
                        "Long-term authentication"
                    ]
                }
            },
            "encryption": {
                "ENCRYPTION_KEY": {
                    "description": "AES-256 encryption key for sensitive data",
                    "type": "hex_string",
                    "length": 32,
                    "charset": "hex",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 120,
                        "grace_period_days": 10
                    },
                    "validation": {
                        "exact_length": 32,
                        "pattern": "^[A-Fa-f0-9]{32}$",
                        "entropy_bits": 128
                    },
                    "usage": [
                        "Database field encryption",
                        "File encryption",
                        "Sensitive configuration encryption"
                    ]
                },
                "API_ENCRYPTION_KEY": {
                    "description": "Secondary encryption key for API payloads",
                    "type": "base64_string",
                    "length": 44,
                    "charset": "base64",
                    "rotation_policy": {
                        "enabled": false,
                        "interval_days": 365
                    },
                    "validation": {
                        "exact_length": 44,
                        "pattern": "^[A-Za-z0-9+/]{43}=$",
                        "entropy_bits": 256
                    },
                    "usage": [
                        "API request encryption",
                        "Webhook payload encryption"
                    ]
                }
            },
            "database": {
                "POSTGRES_PASSWORD": {
                    "description": "PostgreSQL database password",
                    "type": "password",
                    "length": 32,
                    "charset": "alphanumeric_special_safe",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 90,
                        "grace_period_days": 7
                    },
                    "validation": {
                        "min_length": 16,
                        "max_length": 64,
                        "require_uppercase": true,
                        "require_lowercase": true,
                        "require_numbers": true,
                        "require_special": true,
                        "forbidden_chars": [
                            "'",
                            "\"",
                            "\\",
                            ";",
                            "--"
                        ],
                        "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()_+=\\-{}\\[\\]:;<>,.?/~`])[A-Za-z\\d!@#$%^&*()_+=\\-{}\\[\\]:;<>,.?/~`]{16,64}$"
                    },
                    "usage": [
                        "PostgreSQL authentication",
                        "Database connection"
                    ]
                },
                "DB_ENCRYPTION_KEY": {
                    "description": "Database-level encryption key",
                    "type": "hex_string",
                    "length": 32,
                    "charset": "hex",
                    "rotation_policy": {
                        "enabled": false,
                        "interval_days": 365
                    },
                    "validation": {
                        "exact_length": 32,
                        "pattern": "^[A-Fa-f0-9]{32}$"
                    },
                    "usage": [
                        "Database column encryption",
                        "Backup encryption"
                    ]
                }
            },
            "external_services": {
                "WEBHOOK_SIGNING_SECRET": {
                    "description": "Secret for webhook payload signing",
                    "type": "random_string",
                    "length": 48,
                    "charset": "alphanumeric",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 60
                    },
                    "validation": {
                        "min_length": 32,
                        "pattern": "^[A-Za-z0-9]{32,}$"
                    },
                    "usage": [
                        "Webhook signature generation",
                        "Webhook verification"
                    ]
                },
                "API_RATE_LIMIT_SECRET": {
                    "description": "Secret for rate limiting token generation",
                    "type": "random_string",
                    "length": 32,
                    "charset": "alphanumeric",
                    "rotation_policy": {
                        "enabled": true,
                        "interval_days": 30
                    },
                    "validation": {
                        "min_length": 16,
                        "pattern": "^[A-Za-z0-9]{16,}$"
                    },
                    "usage": [
                        "Rate limiting bypass tokens",
                        "Internal service authentication"
                    ]
                }
            }
        },
        "generation_rules": {
            "charset_definitions": {
                "alphanumeric": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
                "alphanumeric_special": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+=-{}[]|:;<>,.?/~`",
                "alphanumeric_special_safe": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+=-{}[]:<>,.?/~`",
                "hex": "0123456789ABCDEF",
                "base64": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
            },
            "entropy_requirements": {
                "minimum_bits": 128,
                "recommended_bits": 256,
                "cryptographic_quality": true
            },
            "validation_patterns": {
                "no_sequential": "(?!.*(?:012|123|234|345|456|567|678|789|890|abc|bcd|cde|def))",
                "no_repeated": "(?!.*(.)\\1{2,})",
                "balanced_charset": "(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)"
            }
        },
        "coolify_integration": {
            "secret_storage": {
                "method": "coolify_secrets",
                "encryption": "AES-256-GCM",
                "access_control": "service_specific",
                "audit_logging": true
            },
            "deployment_secrets": {
                "auto_generate": [
                    "JWT_SECRET",
                    "SESSION_SECRET",
                    "POSTGRES_PASSWORD",
                    "ENCRYPTION_KEY",
                    "WEBHOOK_SIGNING_SECRET"
                ],
                "manual_input": [
                    "REFRESH_TOKEN_SECRET",
                    "API_ENCRYPTION_KEY",
                    "DB_ENCRYPTION_KEY"
                ],
                "optional": [
                    "API_RATE_LIMIT_SECRET"
                ]
            },
            "environment_mapping": {
                "production": {
                    "security_level": "high",
                    "rotation_enabled": true,
                    "audit_required": true
                },
                "staging": {
                    "security_level": "medium",
                    "rotation_enabled": false,
                    "audit_required": false
                },
                "development": {
                    "security_level": "low",
                    "rotation_enabled": false,
                    "audit_required": false
                }
            }
        },
        "security_policies": {
            "access_control": {
                "principle": "least_privilege",
                "service_isolation": true,
                "secret_sharing": "prohibited",
                "cross_environment": "prohibited"
            },
            "rotation_policies": {
                "automatic_rotation": true,
                "rotation_notification": true,
                "grace_period_enforcement": true,
                "rollback_capability": true
            },
            "audit_requirements": {
                "secret_access_logging": true,
                "rotation_logging": true,
                "failed_access_logging": true,
                "retention_days": 90
            },
            "compliance": {
                "standards": [
                    "SOC2",
                    "GDPR",
                    "CCPA"
                ],
                "encryption_at_rest": true,
                "encryption_in_transit": true,
                "key_escrow": false
            }
        }
    }
}